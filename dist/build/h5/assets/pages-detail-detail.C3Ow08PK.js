import{g as a,a as e,c as t,e as s,w as l,F as i,n as c,m as o,i as r,p as d,o as n,b as u,t as f,v as h,k as m,h as p}from"./index-Bd8Evlzh.js";import{r as _,_ as I}from"./uni-app.es.6oN4a-5c.js";import{_ as g}from"./uni-load-more.BEmK_B-1.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=k({data:()=>({comic:{},chapters:[],chapterId:"",bookId:"",loading:!1,error:""}),async onLoad(a){this.chapterId=a.id,this.getDetail()},methods:{goToChapter(a){c({url:`/pages/detail/chapter?id=${a}&rId=${this.chapterId}`})},getDetail(){this.loading=!0,this.error="",o({url:"https://weklfkelnklhoahwcnoj.supabase.co/functions/v1/nocodb/books/read/"+this.chapterId,method:"GET",header:{"content-type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indla2xma2VsbmtsaG9haHdjbm9qIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA5MjIxMjYsImV4cCI6MjA2NjQ5ODEyNn0.fWlmcKQY7bFH-r_EKn_KfX1QO-VxUSA_CRV3jZPJYEg"},success:a=>{console.log(a.data.data),a.data&&a.data.data&&(this.comic=a.data.data,console.log(this.comic),this.bookId=this.comic.book_id,this.getChapterList())},fail:()=>{this.error="加载失败，请检查网络或稍后重试"},complete:()=>{this.loading=!1}})},getChapterList(){o({url:"https://weklfkelnklhoahwcnoj.supabase.co/functions/v1/nocodb/chapters/list/?where=(book_id,eq,"+this.bookId+")&sort=order_num&limit=1000&fields=book_id,title,Id,order_num",method:"GET",header:{"content-type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indla2xma2VsbmtsaG9haHdjbm9qIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA5MjIxMjYsImV4cCI6MjA2NjQ5ODEyNn0.fWlmcKQY7bFH-r_EKn_KfX1QO-VxUSA_CRV3jZPJYEg"},success:a=>{a.data&&a.data.data&&a.data.data.list?(this.chapters=a.data.data.list,console.log(this.chapters)):(this.error="未找到章节信息",this.chapters=[])},fail:()=>{this.error="加载失败，请检查网络或稍后重试"}})},goBack(){c({url:"/pages/list/list"})}}},[["render",function(c,o,k,b,y,j){const v=_(d("uni-icons"),I),C=r,x=_(d("uni-load-more"),g),J=h,w=m;return n(),a(i,null,[e(C,{class:"custom-navbar"},{default:l(()=>[e(C,{class:"nav-left",onClick:j.goBack},{default:l(()=>[e(v,{type:"back",size:"22",color:"#6366f1"})]),_:1},8,["onClick"]),e(C,{class:"nav-title"},{default:l(()=>[u(f("漫画详情"))]),_:1}),e(C,{class:"nav-right"})]),_:1}),y.loading?(n(),t(C,{key:0,style:{"text-align":"center",margin:"32rpx 0"}},{default:l(()=>[e(x,{status:"loading"})]),_:1})):s("",!0),y.comic.Id?(n(),t(C,{key:1,class:"detail-content"},{default:l(()=>[y.comic.cover_url||y.comic.cover?(n(),t(J,{key:0,src:y.comic.cover_url||y.comic.cover,class:"detail-cover",mode:"aspectFill","lazy-load":!0},null,8,["src"])):s("",!0),e(C,{class:"detail-title"},{default:l(()=>[u(f(y.comic.title||y.comic.name||"漫画详情"),1)]),_:1}),y.comic.aliases?(n(),t(C,{key:1,class:"detail-alias"},{default:l(()=>[u("别名："+f(y.comic.aliases),1)]),_:1})):s("",!0),e(C,{class:"info-card"},{default:l(()=>[e(C,{class:"info-row"},{default:l(()=>[e(w,{class:"info-label"},{default:l(()=>[u("作者：")]),_:1}),e(w,{class:"info-value"},{default:l(()=>[u(f(y.comic.author||"未知"),1)]),_:1}),e(w,{class:"info-label"},{default:l(()=>[u("地区：")]),_:1}),e(w,{class:"info-value"},{default:l(()=>[u(f(y.comic.area||"未知"),1)]),_:1})]),_:1}),e(C,{class:"info-row"},{default:l(()=>[e(w,{class:"info-label"},{default:l(()=>[u("状态：")]),_:1}),e(w,{class:"info-value"},{default:l(()=>[u(f(y.comic.status||"未知"),1)]),_:1}),e(w,{class:"info-label"},{default:l(()=>[u("更新时间：")]),_:1}),e(w,{class:"info-value"},{default:l(()=>[u(f(y.comic.update_time||y.comic.UpdatedAt||"未知"),1)]),_:1})]),_:1}),e(C,{class:"info-row"},{default:l(()=>[e(w,{class:"info-label"},{default:l(()=>[u("浏览量：")]),_:1}),e(w,{class:"info-value"},{default:l(()=>[u(f(y.comic.views||0),1)]),_:1}),e(w,{class:"info-label"},{default:l(()=>[u("章节数：")]),_:1}),e(w,{class:"info-value"},{default:l(()=>[u(f(y.comic.chapters||y.chapters.length||0),1)]),_:1})]),_:1}),y.comic.tags?(n(),t(C,{key:0,class:"info-row"},{default:l(()=>[e(w,{class:"info-label"},{default:l(()=>[u("标签：")]),_:1}),e(C,{class:"tags"},{default:l(()=>[(n(!0),a(i,null,p(y.comic.tags.split(","),a=>(n(),t(w,{key:a,class:"tag"},{default:l(()=>[u(f(a),1)]),_:2},1024))),128))]),_:1})]),_:1})):s("",!0)]),_:1}),e(C,{class:"detail-desc"},{default:l(()=>[u(f(y.comic.description||"暂无简介"),1)]),_:1}),y.loading?(n(),t(C,{key:2,style:{"text-align":"center",margin:"32rpx 0"}},{default:l(()=>[u("加载中...")]),_:1})):s("",!0),y.error?(n(),t(C,{key:3,style:{color:"#f00","text-align":"center",margin:"32rpx 0"}},{default:l(()=>[u(f(y.error),1)]),_:1})):s("",!0),y.loading||y.error?s("",!0):(n(),t(C,{key:4},{default:l(()=>[e(C,{class:"divider"}),e(C,{class:"chapter-title"},{default:l(()=>[u(" 章节列表 "),y.chapters.length?(n(),t(w,{key:0},{default:l(()=>[u("("+f(y.chapters.length)+")",1)]),_:1})):s("",!0)]),_:1}),y.chapters.length?(n(),t(C,{key:0,class:"chapter-list"},{default:l(()=>[(n(!0),a(i,null,p(y.chapters,a=>(n(),t(C,{key:a.id||a.Id,class:"chapter-item",onClick:e=>j.goToChapter(a.Id)},{default:l(()=>[e(w,null,{default:l(()=>[u(f(a.title||a.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(n(),t(C,{key:1,style:{"text-align":"center",color:"#aaa"}},{default:l(()=>[u("暂无章节")]),_:1}))]),_:1}))]),_:1})):s("",!0)],64)}],["__scopeId","data-v-eda350bf"]]);export{b as default};
